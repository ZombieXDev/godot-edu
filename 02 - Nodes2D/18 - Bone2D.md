<div dir=rtl>

# Bone2D

`Bone2D` هي عقدة تُستخدم في نظام العظام (skeletal animation) داخل Godot.  
تعمل كعظمة (Bone) تُربط بها الأجزاء الرسومية (مثل Mesh أو Sprite)، وتُستخدم للتحريك (Rigging) والأنيميشن (Animation) بطريقة احترافية.

---

## أين تُستخدم؟

- تُستخدم داخل `Skeleton2D`
- تُستخدم لتحريك شخصيات باستخدام الهيكل العظمي بدلًا من تحريك كل جزء يدويًا
- تسهّل تحريك الشخصيات ذات المفاصل (مثل الذراع، الساق...)

---

## البنية النموذجية

```

Skeleton2D
├── Bone2D (جسم الشخصية - الجسم)
│   ├── Bone2D (يد)
│   │   └── Bone2D (ذراع)
│   └── Bone2D (رجل)

````

---

## الخصائص المهمة

| الخاصية            | الوصف |
|---------------------|-------|
| `rest`              | موضع العظمة الأساسي قبل تطبيق أي حركة (Position, Rotation, Scale). |
| `enabled`           | إذا كانت العظمة مفعلة للتحريك أم لا. |
| `length`            | الطول الافتراضي للعظمة (يظهر كشريط مرئي يساعد على البناء). |
| `bone_index`        | رقم فهرسي (Index) للعظمة داخل `Skeleton2D`. |
| `global_pose_override` | تُستخدم لتعديل حركة العظمة بشكل يدوي (مثل IK أو تأثير برمجي مباشر). |

---

## الدوال (Methods)

| الدالة | الوظيفة |
|--------|----------|
| `get_index()` | يُعيد رقم فهرسي (Index) للعظمة داخل الهيكل العظمي. |
| `apply_rest()` | يُعيد العظمة إلى حالتها الأصلية (rest). |
| `set_bone_angle(angle)` | يُغيّر زاوية دوران العظمة (غالبًا يُستخدم مع السينيما العكسية IK). |
| `set_global_pose_override(transform, amount, persistent)` | يفرض وضعية جديدة للعظمة (تحكم يدوي أو IK). |

---

## استخدام شائع: تحريك ذراع

1. داخل `Skeleton2D`، أضف `Bone2D` لليد وذراع.
2. اربط صورة اليد/الذراع بالعظمة المناسبة.
3. استخدم `AnimationPlayer` لتحريك العظمة.
4. يمكن استخدام IK لجعل الذراع يتبع نقطة معينة.

---

## التحكم الديناميكي عبر كود

<div dir=ltr>

```gdscript
extends Node2D

func _process(delta):
    var bone = $Skeleton2D.get_bone("Hand")
    var angle = (get_global_mouse_position() - bone.global_position).angle()
    bone.set_rotation(angle)
````
<div dir=rtl>

---

## ملاحظات

* العظام تتبع نظام هرمي (parent/child)، فإذا حرّكت العظمة الأم، تتحرك معها العظام التابعة.
* كل `Bone2D` يجب أن يكون داخل `Skeleton2D` لكي تعمل بشكل صحيح.
* العظمة لا ترسم أي رسمة، بل فقط تؤثر على الرسومات المرتبطة بها.

---